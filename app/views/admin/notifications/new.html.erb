<h1>Admin::Notifications#new</h1>
<p>Find me in app/views/admin/notifications/new.html.erb</p>

<div class="container">
	<div class="row">
		<h3>新規通知作成</h3>
	</div>
	<div class="row">
		<div class="col-sm-4">
			<div class="row">
				<%= search_form_for(@q, url: new_admin_notification_path) do |f| %>
					<%= f.search_field :first_name_or_last_name_or_membership_number_eq %>
					<div><%= f.check_box :course_eq_any, {multiple: true}, 1, '' %>数IA 1回目</div>
					<div><%= f.check_box :course_eq_any, {multiple: true}, 2, '' %>数IA 2回目</div>
					<div><%= f.check_box :course_eq_any, {multiple: true}, 3, '' %>数IIB 1回目</div>
					<div><%= f.check_box :course_eq_any, {multiple: true}, 4, '' %>数IIB 2回目</div>
					<div><%= f.check_box :course_eq_any, {multiple: true}, 5, '' %>数IIIC 1回目</div>
					<div><%= f.check_box :course_eq_any, {multiple: true}, 6, '' %>数IIIC 2回目</div>
					<%= f.submit "検索" %>
				<% end %>
			</div>
			<div class="row">
				<div><%= check_box "", "", {class: "all_select"} %>全選択/解除</div>
				<table>
					<thead>
						<th></th>
						<th>氏名</th>
					</thead>
					<% @onlines.each do |online| %>
						<tbody>
							<td><%= check_box "", "onlineId", {}, online.id, false %></td>
							<td><%= online.first_name %><%= online.last_name %></td>
						</tbody>
					<% end %>
				</table>
			</div>
		</div>
		<div class="col-sm-8">
			<div class="row">
				<h4>投稿内容</h4>
			</div>
			<div class="row">
				<%= form_for(@notification, url: admin_notifications_path) do |f| %>
					<div><%= f.text_field :title, placeholder:"title" %></div>
					<div><%= f.text_area :body, class:"form-control", placeholder:"body" %></div>
					<div>
						<%= f.hidden_field :onlineList, :value => "", class: "onlineList" %>
						<%= f.submit "send", class: "btn btn-primary btn-block" %>
					</div>
				<% end %>
			</div>
		</div>
	</div>
</div>


<script>
	const element = document.getElementsByName('onlineId');
	const allSelect = document.querySelector('.all_select');
	const onlineList = document.querySelector('.onlineList');

	// 投稿先全選択
	allSelect.addEventListener('change', function() {
		let onlineArray = new Array();
		for (let i = 0; i < element.length; i++) {
			if (allSelect.checked) {
				element[i].checked = true;
				onlineArray[i] = element[i].value;
			} else {
				element[i].checked = false;
			}
		}
		onlineList.value = onlineArray;
	});

	// 投稿先選択
	element.forEach(function(target) {
		target.addEventListener('change', function() {
			let onlineArray = new Array();
			let num = 0;
			for (let i = 0; i < element.length; i++) {
				if (element[i].checked) {
					onlineArray[num] = element[i].value;
					num ++;
				}
			}
			onlineList.value = onlineArray;
		}, false);
	});
</script>